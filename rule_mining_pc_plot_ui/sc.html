<html>
<head>
</head>
<body>

Rule Support and Confidence Listing

<div id="content">
</div>

<div id="rules">
</div>

<!-- display rules with support and confidence in order given in results.csv and sc.csv -->
<!-- read from query string rows with indices [start, end) using 0-indexed "start" and 0-indexed "end" -->

<script src="jquery-3.1.0.js" charset="utf-8"></script>

<script src="d3.v3.js" charset="utf-8"></script>

<script>
function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
}

// start_str and end_str contain string value of "start" and "end" in query string, respectively, and can be null

var start_str = getParameterByName("start")
var end_str = getParameterByName("end")

var next_start = 0

if (start_str == null) {
  next_start = 0
} else {
  next_start = parseInt(start_str)
}

var next_end = 0

if (end_str == null) {
  next_end = next_start + 10 - 1
} else {
  next_end = parseInt(end_str)
}

var results_data = null

var sc_data = null

var rules_text = ""

d3.csv("results.csv", function(data) {
  next_start = Math.min(data.length - 1, next_start)
  next_end = Math.min(data.length - 1, next_end)

var next_start_shifted = next_start + 1

var next_end_shifted = next_end + 1

$("#content").html("Showing results " + next_start_shifted.toString() + " to " + next_end_shifted.toString() + ".")

results_data = data

d3.csv("sc.csv", function(data) {
  sc_data = data

  // console.log(results_data)

  // console.log(sc_data)

  if (data.length == 0) {
    return
  }

  var columns = d3.keys(results_data[0])
  var rules = results_data
  var sc_values = sc_data

  // console.log(columns)

  var num_columns = columns.length

  // var rules_text

  for (var i = next_start; i < next_end + 1; i++) {

    var rule = rules[i]
    var sc_value = sc_values[i]

    var rule_text = ""

    var rule_num = i + 1

    rule_text += rule_num.toString() + ". "

    support_value = sc_value["support"]
    confidence_value = sc_value["confidence"]

    for (var j = 0; j < num_columns; j++) {

      column = columns[j]

      cell_value = rule[column]

      // BL - using a magic word "EMPTY"

      if (cell_value === "EMPTY") {
        continue;
      }

      // console.log([column, cell_value])

      rule_text += column + ": " + cell_value

      if (j != num_columns - 1) {
        rule_text += ", "
      }

    }

    // console.log([support_value, confidence_value])

    rule_text += ", support: " + support_value + ", confidence: " + confidence_value

    rules_text += rule_text

    if (i != next_end + 1 - 1) {
      rules_text += "<br>"
    }

  }

$("#rules").html("Rules:<br>" + rules_text)

})

})



</script>
</body>
</html>
